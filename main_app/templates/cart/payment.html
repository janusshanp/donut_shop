{% extends 'base.html' %} {% block content %}
{% load static %}

<nav>
    <div class="nav-wrapper">
      <div class="col s12">
        <a href="{% url 'cart' %}" class="breadcrumb">Cart</a>
        <a href="{% url 'payment' %}" class="breadcrumb">Info</a>
        <a href="{% url 'cart_review' %}" class="breadcrumb">Review</a>
		<a href="{% url 'cart_complete' %}" class="breadcrumb">Complete</a>
      </div>
    </div>
</nav>

<div class="row">
	<div class="col s9">
		<form method="POST" action="{% url 'add_info' %}">
			{% csrf_token %}
			<h5>Delivery Information</h4>
			{{ delivery_form.as_p}}
			<button class="btn">Confirm</button>
		</form>
	</div>
	<div class="col s3">
		<table>
			{% for item in items %}
			<tr>
				<td><img class="cart-image" src="{% static item.donut.image %}"></td>
				<td>{{item.donut.name}}</td>
				<td style="display: none" class="price">{{item.donut.price}}</td>
				<td style="display: none" class="quantity">{{item.quantity}}</td>
				<td><span id="total"></span></td>
			</tr>
			{% endfor %}
			<tr>
				<td>Subtotal</td>
				<td></td>
				<td>
					<div class="right-align">$<span id="subtotal">9.99</span></div>
				</td>
			</tr>
			<tr>
				<td>Delivery</td>
				<td></td>
				<td>
					<div class="right-align">$2.99</div>
				</td>
			</tr>
			<tr>
				<td>Total</td>
				<td></td>
				<td>
					<div class="right-align">$<span id="subtotal">9.99</span></div>
				</td>
			</tr>
		</table>
	</div>
</div>

<script>
	totalBox = document.querySelectorAll('#total');
	prices = document.querySelectorAll('.price');
	quantites= document.querySelectorAll('.quantity');
	subTotal= document.querySelectorAll('#subtotal');
	finalTotal = document.querySelectorAll('#final-total')

	total = 0.00
	for (let i=0; i < prices.length; i++){
		totalBox[i].textContent = (parseFloat(prices[i].textContent) * parseFloat(quantites[i].textContent)).toFixed(2)
		total += parseFloat(totalBox[i].textContent)
	}
	console.log(total)

	subTotal[0].textContent = total.toFixed(2)
	finalTotal[0].textContent = (parseFloat(subTotal[0].textContent) + 2.99).toFixed(2) 


</script>
{% endblock %}
